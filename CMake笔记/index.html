<!DOCTYPE html><html class="theme-next pisces" lang="zh-CN"><head><meta charset="UTF-8"><meta name="generator" content="Hexo 3.9.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0"><link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content=""><meta name="baidu-site-verification" content="8gbQ8pd371"><link rel="stylesheet" href="/css/main.css?v=7.3.0"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"7.3.0",exturl:!0,sidebar:{position:"right",display:"post",offset:12,onmobile:!1},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},save_scroll:!0,copycode:{enable:!0,show_result:!1,style:null},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:-1,unescape:!1,preload:!0},path:"search.xml",motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},translation:{copy_button:"复制",copy_success:"复制成功",copy_failure:"复制失败"}}</script><meta name="description" content="CMake简介CMake编译原理CMake常用变量CMake常用实例mkdir Devcd Devmkdir HelloWorldcd HelloWorld sudo apt updatesudo apt upgradesudo apt install vim g++ cmake codelite mkdir srctouch src/Main.cpp vim CMakeLists.txtcmak"><meta name="keywords" content="CMake"><meta property="og:type" content="article"><meta property="og:title" content="CMake笔记"><meta property="og:url" content="https://2694048168.github.io/CMake笔记/index.html"><meta property="og:site_name" content="云主宰苍穹"><meta property="og:description" content="CMake简介CMake编译原理CMake常用变量CMake常用实例mkdir Devcd Devmkdir HelloWorldcd HelloWorld sudo apt updatesudo apt upgradesudo apt install vim g++ cmake codelite mkdir srctouch src/Main.cpp vim CMakeLists.txtcmak"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2020-04-04T08:59:54.250Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="CMake笔记"><meta name="twitter:description" content="CMake简介CMake编译原理CMake常用变量CMake常用实例mkdir Devcd Devmkdir HelloWorldcd HelloWorld sudo apt updatesudo apt upgradesudo apt install vim g++ cmake codelite mkdir srctouch src/Main.cpp vim CMakeLists.txtcmak"><link rel="alternate" href="/atom.xml" title="云主宰苍穹" type="application/atom+xml"><link rel="canonical" href="https://2694048168.github.io/CMake笔记/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,isPage:!1,isArchive:!1}</script><title>CMake笔记 | 云主宰苍穹</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-right"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">云主宰苍穹</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Stay Hungry, Stay Foolish.</h1></div><div class="site-nav-toggle"> <button aria-label="切换导航栏"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益 404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header> <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tLzI2OTQwNDgxNjg=" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></span><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content page-post-detail"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://2694048168.github.io/CMake笔记/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="云主宰苍穹"><meta itemprop="description" content="云主宰苍穹,物联网,嵌入式、云计算、大数据、人工智能、机器学习"><meta itemprop="image" content="/images/liwei.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="云主宰苍穹"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">CMake笔记</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-03-27 15:59:49" itemprop="dateCreated datePublished" datetime="2020-03-27T15:59:49+08:00">2020-03-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-04-04 16:59:54" itemprop="dateModified" datetime="2020-04-04T16:59:54+08:00">2020-04-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C&C++</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>21k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>19 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h4 id="CMake简介"><a href="#CMake简介" class="headerlink" title="CMake简介"></a>CMake简介</h4><h4 id="CMake编译原理"><a href="#CMake编译原理" class="headerlink" title="CMake编译原理"></a>CMake编译原理</h4><h4 id="CMake常用变量"><a href="#CMake常用变量" class="headerlink" title="CMake常用变量"></a>CMake常用变量</h4><h4 id="CMake常用实例"><a href="#CMake常用实例" class="headerlink" title="CMake常用实例"></a>CMake常用实例</h4><p>mkdir Dev<br>cd Dev<br>mkdir HelloWorld<br>cd HelloWorld</p><p>sudo apt update<br>sudo apt upgrade<br>sudo apt install vim g++ cmake codelite</p><p>mkdir src<br>touch src/Main.cpp</p><p>vim CMakeLists.txt<br>cmake_minimum_required (VERSION 3.5)</p><p>project (HelloWorld)</p><p>set (CMAKE_CXX_FLAGS “${CMAKE_CXX_FLAGS} -Wall -Werror -std=c++11”)<br>set (source_dir “${PROJECT_SOURCE_DIR}/src/“)</p><p>file (GLOB source_files “${source_dir}/*.cpp”)</p><p>add_executeable (HelloWorld ${source_files})</p><p>vim build.sh</p><p>#!/bin/sh</p><p>cmake -G “CodeLite - Unix Makefiles” -DCMAKE_BUILD_TYPE=Debug</p><p>chmod +x build.sh<br>./build.sh</p><p>ls<br>codelite HelloWorld.workspace &amp;</p><p>1.CMake编译原理</p><p>CMake是一种跨平台编译工具，比make更为高级，使用起来要方便得多。CMake主要是编写CMakeLists.txt文件，然后用cmake命令将CMakeLists.txt文件转化为make所需要的makefile文件，最后用make命令编译源码生成可执行程序或共享库（so(shared object)）。因此CMake的编译基本就两个步骤：</p><ol><li>cmake</li><li>make</li></ol><p>cmake 指向CMakeLists.txt所在的目录，例如cmake .. 表示CMakeLists.txt在当前目录的上一级目录。cmake后会生成很多编译的中间文件以及makefile文件，所以一般建议新建一个新的目录，专门用来编译，例如</p><p>mkdir build<br>cd build<br>cmake ..<br>make</p><p>make根据生成makefile文件，编译程序。</p><p>2.使用Cmake编译程序</p><p>我们编写一个关于开平方的C/C++程序项目，即b= sqrt(a)，以此理解整个CMake编译的过程。</p><p>a.准备程序文件</p><p>文件目录结构如下：</p><p>.<br>├── build<br>├── CMakeLists.txt<br>├── include<br>│ └── b.h<br>└── src<br> ├── b.c<br> └── main.c</p><p>头文件b.h，如下所示：</p><p>#ifndef B_FILE_HEADER_INC</p><p>#define B_FIEL_HEADER_INC</p><p>#include&lt;math.h&gt;</p><p>double cal_sqrt(double value);</p><p>#endif</p><p>头文件b.c，如下所示：</p><p>#include “../include/b.h”</p><p>double cal_sqrt(double value)<br>{<br> return sqrt(value);<br>}</p><p>main.c主函数，如下所示：</p><p>#include “../include/b.h”</p><p>#include &lt;stdio.h&gt;<br>int main(int argc, char** argv)<br>{<br> double a = 49.0;<br> double b = 0.0;</p><pre><code>printf(&quot;input a:%f\n&quot;,a);
b = cal_sqrt(a);
printf(&quot;sqrt result:%f\n&quot;,b);
return 0;</code></pre><p>}</p><p>b.编写CMakeLists.txt</p><p>接下来编写CMakeLists.txt文件，该文件放在和src，include的同级目录，实际方哪里都可以，只要里面编写的路径能够正确指向就好了。CMakeLists.txt文件，如下所示：</p><p>#1.cmake verson，指定cmake版本<br>cmake_minimum_required(VERSION 3.2)</p><p>#2.project name，指定项目的名称，一般和项目的文件夹名称对应<br>PROJECT(test_sqrt)</p><p>#3.head file path，头文件目录<br>INCLUDE_DIRECTORIES(<br>include<br>)</p><p>#4.source directory，源文件目录<br>AUX_SOURCE_DIRECTORY(src DIR_SRCS)</p><p>#5.set environment variable，设置环境变量，编译用到的源文件全部都要放到这里，否则编译能够通过，但是执行的时候会出现各种问题，比如”symbol lookup error xxxxx , undefined symbol”<br>SET(TEST_MATH<br>${DIR_SRCS}<br>)</p><p>#6.add executable file，添加要编译的可执行文件<br>ADD_EXECUTABLE(${PROJECT_NAME} ${TEST_MATH})</p><p>#7.add link library，添加可执行文件所需要的库，比如我们用到了libm.so（命名规则：lib+name+.so），就添加该库的名称<br>TARGET_LINK_LIBRARIES(${PROJECT_NAME} m)</p><p> CMakeLists.txt主要包含以上的7个步骤，具体的意义，请阅读相应的注释。</p><p>c.编译和运行程序</p><p>准备好了以上的所有材料，接下来，就可以编译了，由于编译中出现许多中间的文件，因此最好新建一个独立的目录build，在该目录下进行编译，编译步骤如下所示：</p><p>mkdir build<br>cd build<br>cmake ..<br>make</p><p>操作后，在build下生成的目录结构如下：</p><p>├── build<br>│ ├── CMakeCache.txt<br>│ ├── CMakeFiles<br>│ │ ├── 3.2.2<br>│ │ │ ├── CMakeCCompiler.cmake<br>│ │ │ ├── CMakeCXXCompiler.cmake<br>│ │ │ ├── CMakeDetermineCompilerABI_C.bin<br>│ │ │ ├── CMakeDetermineCompilerABI_CXX.bin<br>│ │ │ ├── CMakeSystem.cmake<br>│ │ │ ├── CompilerIdC<br>│ │ │ │ ├── a.out<br>│ │ │ │ └── CMakeCCompilerId.c<br>│ │ │ └── CompilerIdCXX<br>│ │ │ ├── a.out<br>│ │ │ └── CMakeCXXCompilerId.cpp<br>│ │ ├── cmake.check_cache<br>│ │ ├── CMakeDirectoryInformation.cmake<br>│ │ ├── CMakeOutput.log<br>│ │ ├── CMakeTmp<br>│ │ ├── feature_tests.bin<br>│ │ ├── feature_tests.c<br>│ │ ├── feature_tests.cxx<br>│ │ ├── Makefile2<br>│ │ ├── Makefile.cmake<br>│ │ ├── progress.marks<br>│ │ ├── TargetDirectories.txt<br>│ │ └── test_sqrt.dir<br>│ │ ├── build.make<br>│ │ ├── C.includecache<br>│ │ ├── cmake_clean.cmake<br>│ │ ├── DependInfo.cmake<br>│ │ ├── depend.internal<br>│ │ ├── depend.make<br>│ │ ├── flags.make<br>│ │ ├── link.txt<br>│ │ ├── progress.make<br>│ │ └── src<br>│ │ ├── b.c.o<br>│ │ └── main.c.o<br>│ ├── cmake_install.cmake<br>│ ├── Makefile<br>│ └── test_sqrt<br>├── CMakeLists.txt<br>├── include<br>│ └── b.h<br>└── src<br> ├── b.c<br> └── main.c</p><p>注意在build的目录下生成了一个可执行的文件test_sqrt,运行获取结果如下：</p><p>命令：<br>./test_sqrt<br>结果：<br>input a:49.000000<br>sqrt result:7.000000</p><p>什么是 CMake<br>All problems in computer science can be solved by another level of indirection.</p><p>David Wheeler<br>你或许听过好几种 Make 工具，例如 GNU Make ，QT 的 qmake ，微软的 MS nmake，BSD Make（pmake），Makepp，等等。这些 Make 工具遵循着不同的规范和标准，所执行的 Makefile 格式也千差万别。这样就带来了一个严峻的问题：如果软件想跨平台，必须要保证能够在不同平台编译。而如果使用上面的 Make 工具，就得为每一种标准写一次 Makefile ，这将是一件让人抓狂的工作。</p><p>CMake 就是针对上面问题所设计的工具：它首先允许开发者编写一种平台无关的 CMakeList.txt 文件来定制整个编译流程，然后再根据目标用户的平台进一步生成所需的本地化 Makefile 和工程文件，如 Unix 的 Makefile 或 Windows 的 Visual Studio 工程。从而做到“Write once, run everywhere”。显然，CMake 是一个比上述几种 make 更高级的编译配置工具。一些使用 CMake 作为项目架构系统的知名开源项目有 VTK、ITK、KDE、OpenCV、OSG 等 [1]。</p><p>在 linux 平台下使用 CMake 生成 Makefile 并编译的流程如下：</p><p>编写 CMake 配置文件 CMakeLists.txt 。<br>执行命令 cmake PATH 或者 ccmake PATH 生成 Makefile（ccmake 和 cmake 的区别在于前者提供了一个交互式的界面）。其中， PATH 是 CMakeLists.txt 所在的目录。<br>使用 make 命令进行编译。<br>本文将从实例入手，一步步讲解 CMake 的常见用法，文中所有的实例代码可以在这里找到。如果你读完仍觉得意犹未尽，可以继续学习我在文章末尾提供的其他资源。</p><p>入门案例：单个源文件<br>本节对应的源代码所在目录：Demo1。</p><p>对于简单的项目，只需要写几行代码就可以了。例如，假设现在我们的项目中只有一个源文件 main.cc ，该程序的用途是计算一个数的指数幂。</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38</p><p>#include &lt;stdio.h&gt;</p><p>#include &lt;stdlib.h&gt;</p><p>/**</p><ul><li><p>power - Calculate the power of number.</p></li><li><p>@param base: Base value.</p></li><li><p>@param exponent: Exponent value.</p></li><li></li><li><p>@return base raised to the power exponent.</p></li><li><p>/<br>double power(double base, int exponent)<br>{<br> int result = base;<br> int i;</p><p> if (exponent == 0) {</p><pre><code>return 1;</code></pre><p> }</p><p> for(i = 1; i &lt; exponent; ++i){</p><pre><code>result = result * base;</code></pre><p> }</p><p> return result;<br>}</p></li></ul><p>int main(int argc, char *argv[])<br>{<br> if (argc &lt; 3){<br> printf(“Usage: %s base exponent \n”, argv[0]);<br> return 1;<br> }<br> double base = atof(argv[1]);<br> int exponent = atoi(argv[2]);<br> double result = power(base, exponent);<br> printf(“%g ^ %d is %g\n”, base, exponent, result);<br> return 0;<br>}<br>编写 CMakeLists.txt<br>首先编写 CMakeLists.txt 文件，并保存在与 main.cc 源文件同个目录下：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8</p><h1 id="CMake-最低版本号要求"><a href="#CMake-最低版本号要求" class="headerlink" title="CMake 最低版本号要求"></a>CMake 最低版本号要求</h1><p>cmake_minimum_required (VERSION 2.8)</p><h1 id="项目信息"><a href="#项目信息" class="headerlink" title="项目信息"></a>项目信息</h1><p>project (Demo1)</p><h1 id="指定生成目标"><a href="#指定生成目标" class="headerlink" title="指定生成目标"></a>指定生成目标</h1><p>add_executable(Demo main.cc)<br>CMakeLists.txt 的语法比较简单，由命令、注释和空格组成，其中命令是不区分大小写的。符号 # 后面的内容被认为是注释。命令由命令名称、小括号和参数组成，参数之间使用空格进行间隔。</p><p>对于上面的 CMakeLists.txt 文件，依次出现了几个命令：</p><p>cmake_minimum_required：指定运行此配置文件所需的 CMake 的最低版本；<br>project：参数值是 Demo1，该命令表示项目的名称是 Demo1 。<br>add_executable： 将名为 main.cc 的源文件编译成一个名称为 Demo 的可执行文件。<br>编译项目<br>之后，在当前目录执行 cmake . ，得到 Makefile 后再使用 make 命令编译得到 Demo1 可执行文件。</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>[ehome@xman Demo1]$ cmake .<br>– The C compiler identification is GNU 4.8.2<br>– The CXX compiler identification is GNU 4.8.2<br>– Check for working C compiler: /usr/sbin/cc<br>– Check for working C compiler: /usr/sbin/cc – works<br>– Detecting C compiler ABI info<br>– Detecting C compiler ABI info - done<br>– Check for working CXX compiler: /usr/sbin/c++<br>– Check for working CXX compiler: /usr/sbin/c++ – works<br>– Detecting CXX compiler ABI info<br>– Detecting CXX compiler ABI info - done<br>– Configuring done<br>– Generating done<br>– Build files have been written to: /home/ehome/Documents/programming/C/power/Demo1<br>[ehome@xman Demo1]$ make<br>Scanning dependencies of target Demo<br>[100%] Building C object CMakeFiles/Demo.dir/main.cc.o<br>Linking C executable Demo<br>[100%] Built target Demo<br>[ehome@xman Demo1]$ ./Demo 5 4<br>5 ^ 4 is 625<br>[ehome@xman Demo1]$ ./Demo 7 3<br>7 ^ 3 is 343<br>[ehome@xman Demo1]$ ./Demo 2 10<br>2 ^ 10 is 1024<br>多个源文件<br>同一目录，多个源文件<br>本小节对应的源代码所在目录：Demo2。</p><p>上面的例子只有单个源文件。现在假如把 power 函数单独写进一个名为 MathFunctions.c 的源文件里，使得这个工程变成如下的形式：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>./Demo2<br> |<br> +— main.cc<br> |<br> +— MathFunctions.cc<br> |<br> +— MathFunctions.h<br>这个时候，CMakeLists.txt 可以改成如下的形式：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8</p><h1 id="CMake-最低版本号要求-1"><a href="#CMake-最低版本号要求-1" class="headerlink" title="CMake 最低版本号要求"></a>CMake 最低版本号要求</h1><p>cmake_minimum_required (VERSION 2.8)</p><h1 id="项目信息-1"><a href="#项目信息-1" class="headerlink" title="项目信息"></a>项目信息</h1><p>project (Demo2)</p><h1 id="指定生成目标-1"><a href="#指定生成目标-1" class="headerlink" title="指定生成目标"></a>指定生成目标</h1><p>add_executable(Demo main.cc MathFunctions.cc)<br>唯一的改动只是在 add_executable 命令中增加了一个 MathFunctions.cc 源文件。这样写当然没什么问题，但是如果源文件很多，把所有源文件的名字都加进去将是一件烦人的工作。更省事的方法是使用 aux_source_directory 命令，该命令会查找指定目录下的所有源文件，然后将结果存进指定变量名。其语法如下：</p><p>1<br>aux_source_directory(<dir><variable>)<br>因此，可以修改 CMakeLists.txt 如下：</variable></dir></p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12</p><h1 id="CMake-最低版本号要求-2"><a href="#CMake-最低版本号要求-2" class="headerlink" title="CMake 最低版本号要求"></a>CMake 最低版本号要求</h1><p>cmake_minimum_required (VERSION 2.8)</p><h1 id="项目信息-2"><a href="#项目信息-2" class="headerlink" title="项目信息"></a>项目信息</h1><p>project (Demo2)</p><h1 id="查找当前目录下的所有源文件"><a href="#查找当前目录下的所有源文件" class="headerlink" title="查找当前目录下的所有源文件"></a>查找当前目录下的所有源文件</h1><h1 id="并将名称保存到-DIR-SRCS-变量"><a href="#并将名称保存到-DIR-SRCS-变量" class="headerlink" title="并将名称保存到 DIR_SRCS 变量"></a>并将名称保存到 DIR_SRCS 变量</h1><p>aux_source_directory(. DIR_SRCS)</p><h1 id="指定生成目标-2"><a href="#指定生成目标-2" class="headerlink" title="指定生成目标"></a>指定生成目标</h1><p>add_executable(Demo ${DIR_SRCS})<br>这样，CMake 会将当前目录所有源文件的文件名赋值给变量 DIR_SRCS ，再指示变量 DIR_SRCS 中的源文件需要编译成一个名称为 Demo 的可执行文件。</p><p>多个目录，多个源文件<br>本小节对应的源代码所在目录：Demo3。</p><p>现在进一步将 MathFunctions.h 和 MathFunctions.cc 文件移动到 math 目录下。</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>./Demo3<br> |<br> +— main.cc<br> |<br> +— math/<br> |<br> +— MathFunctions.cc<br> |<br> +— MathFunctions.h<br>对于这种情况，需要分别在项目根目录 Demo3 和 math 目录里各编写一个 CMakeLists.txt 文件。为了方便，我们可以先将 math 目录里的文件编译成静态库再由 main 函数调用。</p><p>根目录中的 CMakeLists.txt ：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18</p><h1 id="CMake-最低版本号要求-3"><a href="#CMake-最低版本号要求-3" class="headerlink" title="CMake 最低版本号要求"></a>CMake 最低版本号要求</h1><p>cmake_minimum_required (VERSION 2.8)</p><h1 id="项目信息-3"><a href="#项目信息-3" class="headerlink" title="项目信息"></a>项目信息</h1><p>project (Demo3)</p><h1 id="查找当前目录下的所有源文件-1"><a href="#查找当前目录下的所有源文件-1" class="headerlink" title="查找当前目录下的所有源文件"></a>查找当前目录下的所有源文件</h1><h1 id="并将名称保存到-DIR-SRCS-变量-1"><a href="#并将名称保存到-DIR-SRCS-变量-1" class="headerlink" title="并将名称保存到 DIR_SRCS 变量"></a>并将名称保存到 DIR_SRCS 变量</h1><p>aux_source_directory(. DIR_SRCS)</p><h1 id="添加-math-子目录"><a href="#添加-math-子目录" class="headerlink" title="添加 math 子目录"></a>添加 math 子目录</h1><p>add_subdirectory(math)</p><h1 id="指定生成目标-3"><a href="#指定生成目标-3" class="headerlink" title="指定生成目标"></a>指定生成目标</h1><p>add_executable(Demo main.cc)</p><h1 id="添加链接库"><a href="#添加链接库" class="headerlink" title="添加链接库"></a>添加链接库</h1><p>target_link_libraries(Demo MathFunctions)<br>该文件添加了下面的内容: 第3行，使用命令 add_subdirectory 指明本项目包含一个子目录 math，这样 math 目录下的 CMakeLists.txt 文件和源代码也会被处理 。第6行，使用命令 target_link_libraries 指明可执行文件 main 需要连接一个名为 MathFunctions 的链接库 。</p><p>子目录中的 CMakeLists.txt：</p><p>1<br>2<br>3<br>4<br>5<br>6</p><h1 id="查找当前目录下的所有源文件-2"><a href="#查找当前目录下的所有源文件-2" class="headerlink" title="查找当前目录下的所有源文件"></a>查找当前目录下的所有源文件</h1><h1 id="并将名称保存到-DIR-LIB-SRCS-变量"><a href="#并将名称保存到-DIR-LIB-SRCS-变量" class="headerlink" title="并将名称保存到 DIR_LIB_SRCS 变量"></a>并将名称保存到 DIR_LIB_SRCS 变量</h1><p>aux_source_directory(. DIR_LIB_SRCS)</p><h1 id="生成链接库"><a href="#生成链接库" class="headerlink" title="生成链接库"></a>生成链接库</h1><p>add_library (MathFunctions ${DIR_LIB_SRCS})<br>在该文件中使用命令 add_library 将 src 目录中的源文件编译为静态链接库。</p><p>自定义编译选项<br>本节对应的源代码所在目录：Demo4。</p><p>CMake 允许为项目增加编译选项，从而可以根据用户的环境和需求选择最合适的编译方案。</p><p>例如，可以将 MathFunctions 库设为一个可选的库，如果该选项为 ON ，就使用该库定义的数学函数来进行运算。否则就调用标准库中的数学函数库。</p><p>修改 CMakeLists 文件<br>我们要做的第一步是在顶层的 CMakeLists.txt 文件中添加该选项：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30</p><h1 id="CMake-最低版本号要求-4"><a href="#CMake-最低版本号要求-4" class="headerlink" title="CMake 最低版本号要求"></a>CMake 最低版本号要求</h1><p>cmake_minimum_required (VERSION 2.8)</p><h1 id="项目信息-4"><a href="#项目信息-4" class="headerlink" title="项目信息"></a>项目信息</h1><p>project (Demo4)</p><h1 id="加入一个配置头文件，用于处理-CMake-对源码的设置"><a href="#加入一个配置头文件，用于处理-CMake-对源码的设置" class="headerlink" title="加入一个配置头文件，用于处理 CMake 对源码的设置"></a>加入一个配置头文件，用于处理 CMake 对源码的设置</h1><p>configure_file (<br> “${PROJECT_SOURCE_DIR}/config.h.in”<br> “${PROJECT_BINARY_DIR}/config.h”<br> )</p><h1 id="是否使用自己的-MathFunctions-库"><a href="#是否使用自己的-MathFunctions-库" class="headerlink" title="是否使用自己的 MathFunctions 库"></a>是否使用自己的 MathFunctions 库</h1><p>option (USE_MYMATH<br> “Use provided math implementation” ON)</p><h1 id="是否加入-MathFunctions-库"><a href="#是否加入-MathFunctions-库" class="headerlink" title="是否加入 MathFunctions 库"></a>是否加入 MathFunctions 库</h1><p>if (USE_MYMATH)<br> include_directories (“${PROJECT_SOURCE_DIR}/math”)<br> add_subdirectory (math)<br> set (EXTRA_LIBS ${EXTRA_LIBS} MathFunctions)<br>endif (USE_MYMATH)</p><h1 id="查找当前目录下的所有源文件-3"><a href="#查找当前目录下的所有源文件-3" class="headerlink" title="查找当前目录下的所有源文件"></a>查找当前目录下的所有源文件</h1><h1 id="并将名称保存到-DIR-SRCS-变量-2"><a href="#并将名称保存到-DIR-SRCS-变量-2" class="headerlink" title="并将名称保存到 DIR_SRCS 变量"></a>并将名称保存到 DIR_SRCS 变量</h1><p>aux_source_directory(. DIR_SRCS)</p><h1 id="指定生成目标-4"><a href="#指定生成目标-4" class="headerlink" title="指定生成目标"></a>指定生成目标</h1><p>add_executable(Demo ${DIR_SRCS})<br>target_link_libraries (Demo ${EXTRA_LIBS})<br>其中：</p><p>第7行的 configure_file 命令用于加入一个配置头文件 config.h ，这个文件由 CMake 从 config.h.in 生成，通过这样的机制，将可以通过预定义一些参数和变量来控制代码的生成。<br>第13行的 option 命令添加了一个 USE_MYMATH 选项，并且默认值为 ON 。<br>第17行根据 USE_MYMATH 变量的值来决定是否使用我们自己编写的 MathFunctions 库。<br>修改 main.cc 文件<br>之后修改 main.cc 文件，让其根据 USE_MYMATH 的预定义值来决定是否调用标准库还是 MathFunctions 库：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30</p><p>#include &lt;stdio.h&gt;</p><p>#include &lt;stdlib.h&gt;</p><p>#include “config.h”</p><p>#ifdef USE_MYMATH</p><p> #include “math/MathFunctions.h”</p><p>#else</p><p> #include &lt;math.h&gt;</p><p>#endif</p><p>int main(int argc, char *argv[])<br>{<br> if (argc &lt; 3){<br> printf(“Usage: %s base exponent \n”, argv[0]);<br> return 1;<br> }<br> double base = atof(argv[1]);<br> int exponent = atoi(argv[2]);</p><p>#ifdef USE_MYMATH<br> printf(“Now we use our own Math library. \n”);<br> double result = power(base, exponent);</p><p>#else<br> printf(“Now we use the standard library. \n”);<br> double result = pow(base, exponent);</p><p>#endif<br> printf(“%g ^ %d is %g\n”, base, exponent, result);<br> return 0;<br>}<br>编写 config.h.in 文件<br>上面的程序值得注意的是第2行，这里引用了一个 config.h 文件，这个文件预定义了 USE_MYMATH 的值。但我们并不直接编写这个文件，为了方便从 CMakeLists.txt 中导入配置，我们编写一个 config.h.in 文件，内容如下：</p><p>1</p><p>#cmakedefine USE_MYMATH<br>这样 CMake 会自动根据 CMakeLists 配置文件中的设置自动生成 config.h 文件。</p><p>编译项目<br>现在编译一下这个项目，为了便于交互式的选择该变量的值，可以使用 ccmake 命令（也可以使用 cmake -i 命令，该命令会提供一个会话式的交互式配置界面）：</p><p>CMake的交互式配置界面<br>CMake的交互式配置界面<br>从中可以找到刚刚定义的 USE_MYMATH 选项，按键盘的方向键可以在不同的选项窗口间跳转，按下 enter 键可以修改该选项。修改完成后可以按下 c 选项完成配置，之后再按 g 键确认生成 Makefile 。ccmake 的其他操作可以参考窗口下方给出的指令提示。</p><p>我们可以试试分别将 USE_MYMATH 设为 ON 和 OFF 得到的结果：</p><p>USE_MYMATH 为 ON<br>运行结果：</p><p>1<br>2<br>3<br>4<br>5<br>[ehome@xman Demo4]$ ./Demo<br>Now we use our own MathFunctions library.<br> 7 ^ 3 = 343.000000<br> 10 ^ 5 = 100000.000000<br> 2 ^ 10 = 1024.000000<br>此时 config.h 的内容为：</p><p>1</p><p>#define USE_MYMATH<br>USE_MYMATH 为 OFF<br>运行结果：</p><p>1<br>2<br>3<br>4<br>5<br>[ehome@xman Demo4]$ ./Demo<br>Now we use the standard library.<br> 7 ^ 3 = 343.000000<br> 10 ^ 5 = 100000.000000<br> 2 ^ 10 = 1024.000000<br>此时 config.h 的内容为：</p><p>1<br>/* #undef USE_MYMATH */<br>安装和测试<br>本节对应的源代码所在目录：Demo5。</p><p>CMake 也可以指定安装规则，以及添加测试。这两个功能分别可以通过在产生 Makefile 后使用 make install 和 make test 来执行。在以前的 GNU Makefile 里，你可能需要为此编写 install 和 test 两个伪目标和相应的规则，但在 CMake 里，这样的工作同样只需要简单的调用几条命令。</p><p>定制安装规则<br>首先先在 math/CMakeLists.txt 文件里添加下面两行：</p><p>1<br>2<br>3</p><h1 id="指定-MathFunctions-库的安装路径"><a href="#指定-MathFunctions-库的安装路径" class="headerlink" title="指定 MathFunctions 库的安装路径"></a>指定 MathFunctions 库的安装路径</h1><p>install (TARGETS MathFunctions DESTINATION bin)<br>install (FILES MathFunctions.h DESTINATION include)<br>指明 MathFunctions 库的安装路径。之后同样修改根目录的 CMakeLists 文件，在末尾添加下面几行：</p><p>1<br>2<br>3<br>4</p><h1 id="指定安装路径"><a href="#指定安装路径" class="headerlink" title="指定安装路径"></a>指定安装路径</h1><p>install (TARGETS Demo DESTINATION bin)<br>install (FILES “${PROJECT_BINARY_DIR}/config.h”<br> DESTINATION include)<br>通过上面的定制，生成的 Demo 文件和 MathFunctions 函数库 libMathFunctions.o 文件将会被复制到 /usr/local/bin 中，而 MathFunctions.h 和生成的 config.h 文件则会被复制到 /usr/local/include 中。我们可以验证一下（顺带一提的是，这里的 /usr/local/ 是默认安装到的根目录，可以通过修改 CMAKE_INSTALL_PREFIX 变量的值来指定这些文件应该拷贝到哪个根目录）：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>[ehome@xman Demo5]$ sudo make install<br>[ 50%] Built target MathFunctions<br>[100%] Built target Demo<br>Install the project…<br>– Install configuration: “”<br>– Installing: /usr/local/bin/Demo<br>– Installing: /usr/local/include/config.h<br>– Installing: /usr/local/bin/libMathFunctions.a<br>– Up-to-date: /usr/local/include/MathFunctions.h<br>[ehome@xman Demo5]$ ls /usr/local/bin<br>Demo libMathFunctions.a<br>[ehome@xman Demo5]$ ls /usr/local/include<br>config.h MathFunctions.h<br>为工程添加测试<br>添加测试同样很简单。CMake 提供了一个称为 CTest 的测试工具。我们要做的只是在项目根目录的 CMakeLists 文件中调用一系列的 add_test 命令。</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28</p><h1 id="启用测试"><a href="#启用测试" class="headerlink" title="启用测试"></a>启用测试</h1><p>enable_testing()</p><h1 id="测试程序是否成功运行"><a href="#测试程序是否成功运行" class="headerlink" title="测试程序是否成功运行"></a>测试程序是否成功运行</h1><p>add_test (test_run Demo 5 2)</p><h1 id="测试帮助信息是否可以正常提示"><a href="#测试帮助信息是否可以正常提示" class="headerlink" title="测试帮助信息是否可以正常提示"></a>测试帮助信息是否可以正常提示</h1><p>add_test (test_usage Demo)<br>set_tests_properties (test_usage<br> PROPERTIES PASS_REGULAR_EXPRESSION “Usage: .* base exponent”)</p><h1 id="测试-5-的平方"><a href="#测试-5-的平方" class="headerlink" title="测试 5 的平方"></a>测试 5 的平方</h1><p>add_test (test_5_2 Demo 5 2)</p><p>set_tests_properties (test_5_2<br> PROPERTIES PASS_REGULAR_EXPRESSION “is 25”)</p><h1 id="测试-10-的-5-次方"><a href="#测试-10-的-5-次方" class="headerlink" title="测试 10 的 5 次方"></a>测试 10 的 5 次方</h1><p>add_test (test_10_5 Demo 10 5)</p><p>set_tests_properties (test_10_5<br> PROPERTIES PASS_REGULAR_EXPRESSION “is 100000”)</p><h1 id="测试-2-的-10-次方"><a href="#测试-2-的-10-次方" class="headerlink" title="测试 2 的 10 次方"></a>测试 2 的 10 次方</h1><p>add_test (test_2_10 Demo 2 10)</p><p>set_tests_properties (test_2_10<br> PROPERTIES PASS_REGULAR_EXPRESSION “is 1024”)<br>上面的代码包含了四个测试。第一个测试 test_run 用来测试程序是否成功运行并返回 0 值。剩下的三个测试分别用来测试 5 的 平方、10 的 5 次方、2 的 10 次方是否都能得到正确的结果。其中 PASS_REGULAR_EXPRESSION 用来测试输出是否包含后面跟着的字符串。</p><p>让我们看看测试的结果：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>[ehome@xman Demo5]$ make test<br>Running tests…<br>Test project /home/ehome/Documents/programming/C/power/Demo5<br> Start 1: test_run<br>1/4 Test #1: test_run ……………………. Passed 0.00 sec<br> Start 2: test_5_2<br>2/4 Test #2: test_5_2 ……………………. Passed 0.00 sec<br> Start 3: test_10_5<br>3/4 Test #3: test_10_5 …………………… Passed 0.00 sec<br> Start 4: test_2_10<br>4/4 Test #4: test_2_10 …………………… Passed 0.00 sec</p><p>100% tests passed, 0 tests failed out of 4</p><p>Total Test time (real) = 0.01 sec<br>如果要测试更多的输入数据，像上面那样一个个写测试用例未免太繁琐。这时可以通过编写宏来实现：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11</p><h1 id="定义一个宏，用来简化测试工作"><a href="#定义一个宏，用来简化测试工作" class="headerlink" title="定义一个宏，用来简化测试工作"></a>定义一个宏，用来简化测试工作</h1><p>macro (do_test arg1 arg2 result)<br> add_test (test_${arg1}<em>${arg2} Demo ${arg1} ${arg2})<br> set_tests_properties (test</em>${arg1}_${arg2}<br> PROPERTIES PASS_REGULAR_EXPRESSION ${result})<br>endmacro (do_test)</p><h1 id="使用该宏进行一系列的数据测试"><a href="#使用该宏进行一系列的数据测试" class="headerlink" title="使用该宏进行一系列的数据测试"></a>使用该宏进行一系列的数据测试</h1><p>do_test (5 2 “is 25”)<br>do_test (10 5 “is 100000”)<br>do_test (2 10 “is 1024”)<br>关于 CTest 的更详细的用法可以通过 man 1 ctest 参考 CTest 的文档。</p><p>支持 gdb<br>让 CMake 支持 gdb 的设置也很容易，只需要指定 Debug 模式下开启 -g 选项：</p><p>1<br>2<br>3<br>set(CMAKE_BUILD_TYPE “Debug”)<br>set(CMAKE_CXX_FLAGS_DEBUG “$ENV{CXXFLAGS} -O0 -Wall -g -ggdb”)<br>set(CMAKE_CXX_FLAGS_RELEASE “$ENV{CXXFLAGS} -O3 -Wall”)<br>之后可以直接对生成的程序使用 gdb 来调试。</p><p>添加环境检查<br>本节对应的源代码所在目录：Demo6。</p><p>有时候可能要对系统环境做点检查，例如要使用一个平台相关的特性的时候。在这个例子中，我们检查系统是否自带 pow 函数。如果带有 pow 函数，就使用它；否则使用我们定义的 power 函数。</p><p>添加 CheckFunctionExists 宏<br>首先在顶层 CMakeLists 文件中添加 CheckFunctionExists.cmake 宏，并调用 check_function_exists 命令测试链接器是否能够在链接阶段找到 pow 函数。</p><p>1<br>2<br>3</p><h1 id="检查系统是否支持-pow-函数"><a href="#检查系统是否支持-pow-函数" class="headerlink" title="检查系统是否支持 pow 函数"></a>检查系统是否支持 pow 函数</h1><p>include (${CMAKE_ROOT}/Modules/CheckFunctionExists.cmake)<br>check_function_exists (pow HAVE_POW)<br>将上面这段代码放在 configure_file 命令前。</p><p>预定义相关宏变量<br>接下来修改 config.h.in 文件，预定义相关的宏变量。</p><p>1<br>2<br>// does the platform provide pow function?</p><p>#cmakedefine HAVE_POW<br>在代码中使用宏和函数<br>最后一步是修改 main.cc ，在代码中使用宏和函数：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7</p><p>#ifdef HAVE_POW<br> printf(“Now we use the standard library. \n”);<br> double result = pow(base, exponent);</p><p>#else<br> printf(“Now we use our own Math library. \n”);<br> double result = power(base, exponent);</p><p>#endif<br>添加版本号<br>本节对应的源代码所在目录：Demo7。</p><p>给项目添加和维护版本号是一个好习惯，这样有利于用户了解每个版本的维护情况，并及时了解当前所用的版本是否过时，或是否可能出现不兼容的情况。</p><p>首先修改顶层 CMakeLists 文件，在 project 命令之后加入如下两行：</p><p>1<br>2<br>set (Demo_VERSION_MAJOR 1)<br>set (Demo_VERSION_MINOR 0)<br>分别指定当前的项目的主版本号和副版本号。</p><p>之后，为了在代码中获取版本信息，我们可以修改 config.h.in 文件，添加两个预定义变量：</p><p>1<br>2<br>3<br>// the configured options and settings for Tutorial</p><p>#define Demo_VERSION_MAJOR @Demo_VERSION_MAJOR@</p><p>#define Demo_VERSION_MINOR @Demo_VERSION_MINOR@<br>这样就可以直接在代码中打印版本信息了：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31</p><p>#include &lt;stdio.h&gt;</p><p>#include &lt;stdlib.h&gt;</p><p>#include &lt;math.h&gt;</p><p>#include “config.h”</p><p>#include “math/MathFunctions.h”</p><p>int main(int argc, char *argv[])<br>{<br> if (argc &lt; 3){<br> // print version info<br> printf(“%s Version %d.%d\n”,<br> argv[0],<br> Demo_VERSION_MAJOR,<br> Demo_VERSION_MINOR);<br> printf(“Usage: %s base exponent \n”, argv[0]);<br> return 1;<br> }<br> double base = atof(argv[1]);<br> int exponent = atoi(argv[2]);</p><p>#if defined (HAVE_POW)<br> printf(“Now we use the standard library. \n”);<br> double result = pow(base, exponent);</p><p>#else<br> printf(“Now we use our own Math library. \n”);<br> double result = power(base, exponent);</p><p>#endif</p><pre><code>printf(&quot;%g ^ %d is %g\n&quot;, base, exponent, result);
return 0;</code></pre><p>}<br>生成安装包<br>本节对应的源代码所在目录：Demo8。</p><p>本节将学习如何配置生成各种平台上的安装包，包括二进制安装包和源码安装包。为了完成这个任务，我们需要用到 CPack ，它同样也是由 CMake 提供的一个工具，专门用于打包。</p><p>首先在顶层的 CMakeLists.txt 文件尾部添加下面几行：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7</p><h1 id="构建一个-CPack-安装包"><a href="#构建一个-CPack-安装包" class="headerlink" title="构建一个 CPack 安装包"></a>构建一个 CPack 安装包</h1><p>include (InstallRequiredSystemLibraries)<br>set (CPACK_RESOURCE_FILE_LICENSE<br> “${CMAKE_CURRENT_SOURCE_DIR}/License.txt”)<br>set (CPACK_PACKAGE_VERSION_MAJOR “${Demo_VERSION_MAJOR}”)<br>set (CPACK_PACKAGE_VERSION_MINOR “${Demo_VERSION_MINOR}”)<br>include (CPack)<br>上面的代码做了以下几个工作：</p><p>导入 InstallRequiredSystemLibraries 模块，以便之后导入 CPack 模块；<br>设置一些 CPack 相关变量，包括版权信息和版本信息，其中版本信息用了上一节定义的版本号；<br>导入 CPack 模块。<br>接下来的工作是像往常一样构建工程，并执行 cpack 命令。</p><p>生成二进制安装包：<br>1<br>cpack -C CPackConfig.cmake<br>生成源码安装包<br>1<br>cpack -C CPackSourceConfig.cmake<br>我们可以试一下。在生成项目后，执行 cpack -C CPackConfig.cmake 命令：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>[ehome@xman Demo8]$ cpack -C CPackSourceConfig.cmake<br>CPack: Create package using STGZ<br>CPack: Install projects<br>CPack: - Run preinstall target for: Demo8<br>CPack: - Install project: Demo8<br>CPack: Create package<br>CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux.sh generated.<br>CPack: Create package using TGZ<br>CPack: Install projects<br>CPack: - Run preinstall target for: Demo8<br>CPack: - Install project: Demo8<br>CPack: Create package<br>CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux.tar.gz generated.<br>CPack: Create package using TZ<br>CPack: Install projects<br>CPack: - Run preinstall target for: Demo8<br>CPack: - Install project: Demo8<br>CPack: Create package<br>CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux.tar.Z generated.<br>此时会在该目录下创建 3 个不同格式的二进制包文件：</p><p>1<br>2<br>[ehome@xman Demo8]$ ls Demo8-*<br>Demo8-1.0.1-Linux.sh Demo8-1.0.1-Linux.tar.gz Demo8-1.0.1-Linux.tar.Z<br>这 3 个二进制包文件所包含的内容是完全相同的。我们可以执行其中一个。此时会出现一个由 CPack 自动生成的交互式安装界面：</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>[ehome@xman Demo8]$ sh Demo8-1.0.1-Linux.sh<br>Demo8 Installer Version: 1.0.1, Copyright (c) Humanity<br>This is a self-extracting archive.<br>The archive will be extracted to: /home/ehome/Documents/programming/C/power/Demo8</p><p>If you want to stop extracting, please press<ctrl-c>.<br>The MIT License (MIT)</ctrl-c></p><p>Copyright (c) 2013 Joseph Pan(<span class="exturl" data-url="aHR0cDovL2hhaGFjay5jb20=" title="http://hahack.com">http://hahack.com<i class="fa fa-external-link"></i></span>)</p><p>Permission is hereby granted, free of charge, to any person obtaining a copy of<br>this software and associated documentation files (the “Software”), to deal in<br>the Software without restriction, including without limitation the rights to<br>use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of<br>the Software, and to permit persons to whom the Software is furnished to do so,<br>subject to the following conditions:</p><p>The above copyright notice and this permission notice shall be included in all<br>copies or substantial portions of the Software.</p><p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR<br>IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS<br>FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR<br>COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER<br>IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN<br>CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p><p>Do you accept the license? [yN]:<br>y<br>By default the Demo8 will be installed in:<br> “/home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux”<br>Do you want to include the subdirectory Demo8-1.0.1-Linux?<br>Saying no will install in: “/home/ehome/Documents/programming/C/power/Demo8” [Yn]:<br>y</p><p>Using target directory: /home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux<br>Extracting, please wait…</p><p>Unpacking finished successfully<br>完成后提示安装到了 Demo8-1.0.1-Linux 子目录中，我们可以进去执行该程序：</p><p>1<br>2<br>3<br>[ehome@xman Demo8]$ ./Demo8-1.0.1-Linux/bin/Demo 5 2<br>Now we use our own Math library.<br>5 ^ 2 is 25<br>关于 CPack 的更详细的用法可以通过 man 1 cpack 参考 CPack 的文档。</p><p>将其他平台的项目迁移到 CMake<br>CMake 可以很轻松地构建出在适合各个平台执行的工程环境。而如果当前的工程环境不是 CMake ，而是基于某个特定的平台，是否可以迁移到 CMake 呢？答案是可能的。下面针对几个常用的平台，列出了它们对应的迁移方案。</p><p>autotools<br>am2cmake 可以将 autotools 系的项目转换到 CMake，这个工具的一个成功案例是 KDE 。<br>Alternative Automake2CMake 可以转换使用 automake 的 KDevelop 工程项目。<br>Converting autoconf tests<br>qmake<br>qmake converter 可以转换使用 QT 的 qmake 的工程。<br>Visual Studio<br>vcproj2cmake.rb 可以根据 Visual Studio 的工程文件（后缀名是 .vcproj 或 .vcxproj）生成 CMakeLists.txt 文件。<br>vcproj2cmake.ps1 vcproj2cmake 的 PowerShell 版本。<br>folders4cmake 根据 Visual Studio 项目文件生成相应的 “source_group” 信息，这些信息可以很方便的在 CMake 脚本中使用。支持 Visual Studio 9/10 工程文件。<br>CMakeLists.txt 自动推导<br>gencmake 根据现有文件推导 CMakeLists.txt 文件。<br>CMakeListGenerator 应用一套文件和目录分析创建出完整的 CMakeLists.txt 文件。仅支持 Win32 平台。<br>相关链接<br>官方主页<br>官方文档<br>官方教程<br>Wiki<br>FAQ<br>bug tracker<br>邮件列表：<br>cmake on Gmane<br><span class="exturl" data-url="aHR0cDovL3d3dy5tYWlsLWFyY2hpdmUuY29tL2NtYWtlQGNtYWtlLm9yZy8=" title="http://www.mail-archive.com/cmake@cmake.org/">http://www.mail-archive.com/cmake@cmake.org/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL21hcmMuaW5mby8/bD1jbWFrZQ==" title="http://marc.info/?l=cmake">http://marc.info/?l=cmake<i class="fa fa-external-link"></i></span><br>其他推荐文章<br>在 linux 下使用 CMake 构建应用程序<br>cmake的一些小经验<br>Packaging Software with CPack<br>视频教程: 《Getting Started with CMake》<br>类似工具</p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读，欢迎分享！-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script><script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script><link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css"><p><span>本文标题:</span>CMake笔记</p><p><span>文章作者:</span>云主宰苍穹</p><p><span>原始链接:</span><a href="/CMake笔记/" title="CMake笔记">https://2694048168.github.io/CMake笔记/</a><span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://2694048168.github.io/CMake笔记/" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");clipboard.on("success",$(function(){$(".fa-clipboard").click(function(){swal({title:"",text:"复制成功",html:!1,timer:500,showConfirmButton:!1})})}))</script></div><div id="reward-container"><div></div> <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';"> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/images/wechatpay.png" alt="云主宰苍穹 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/images/alipay.png" alt="云主宰苍穹 支付宝"><p>支付宝</p></div></div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/CMake/" rel="tag"># CMake</a></div><div class="post-widgets"><div class="social-share"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/C++笔记/" rel="next" title="C++笔记"><i class="fa fa-chevron-left"></i> C++笔记</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/终端显示Linux系统信息/" rel="prev" title="终端显示Linux系统信息">终端显示Linux系统信息<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="gitalk-container"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/liwei.jpg" alt="云主宰苍穹"><p class="site-author-name" itemprop="name">云主宰苍穹</p><div class="site-description motion-element" itemprop="description">云主宰苍穹,物联网,嵌入式、云计算、大数据、人工智能、机器学习</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">25</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tLzI2OTQwNDgxNjgv" title="GitHub &rarr; https://github.com/2694048168/"><i class="fa fa-fw fa-github"></i> GitHub</span></span><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly93ZWliby5jb20vNTk2MzU1MzMwOS8=" title="Weibo &rarr; https://weibo.com/5963553309/"><i class="fa fa-fw fa-weibo"></i> Weibo</span></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <span class="exturl" data-url="aHR0cHM6Ly9hdXRob3IuYmFpZHUuY29tL2hvbWUvMTYyMzY0NDY2NjE2MjYwMS8=" title="https://author.baidu.com/home/1623644666162601/">百家号-专注物联网知识</span></li><li class="links-of-blogroll-item"> <span class="exturl" data-url="aHR0cHM6Ly93d3cudG91dGlhby5jb20vYy91c2VyLzIwMDk1NDExMTY2OTkwNzkv" title="https://www.toutiao.com/c/user/2009541116699079/">头条号-专注物联网知识</span></li><li class="links-of-blogroll-item"> <span class="exturl" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMzYyOTAxODc3Lw==" title="https://space.bilibili.com/362901877/">哔哩哔哩-云主宰苍穹</span></li></ul></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#CMake简介"><span class="nav-number">1.</span> <span class="nav-text">CMake简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMake编译原理"><span class="nav-number">2.</span> <span class="nav-text">CMake编译原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMake常用变量"><span class="nav-number">3.</span> <span class="nav-text">CMake常用变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMake常用实例"><span class="nav-number">4.</span> <span class="nav-text">CMake常用实例</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#CMake-最低版本号要求"><span class="nav-number"></span> <span class="nav-text">CMake 最低版本号要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目信息"><span class="nav-number"></span> <span class="nav-text">项目信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定生成目标"><span class="nav-number"></span> <span class="nav-text">指定生成目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CMake-最低版本号要求-1"><span class="nav-number"></span> <span class="nav-text">CMake 最低版本号要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目信息-1"><span class="nav-number"></span> <span class="nav-text">项目信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定生成目标-1"><span class="nav-number"></span> <span class="nav-text">指定生成目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CMake-最低版本号要求-2"><span class="nav-number"></span> <span class="nav-text">CMake 最低版本号要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目信息-2"><span class="nav-number"></span> <span class="nav-text">项目信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查找当前目录下的所有源文件"><span class="nav-number"></span> <span class="nav-text">查找当前目录下的所有源文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#并将名称保存到-DIR-SRCS-变量"><span class="nav-number"></span> <span class="nav-text">并将名称保存到 DIR_SRCS 变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定生成目标-2"><span class="nav-number"></span> <span class="nav-text">指定生成目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CMake-最低版本号要求-3"><span class="nav-number"></span> <span class="nav-text">CMake 最低版本号要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目信息-3"><span class="nav-number"></span> <span class="nav-text">项目信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查找当前目录下的所有源文件-1"><span class="nav-number"></span> <span class="nav-text">查找当前目录下的所有源文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#并将名称保存到-DIR-SRCS-变量-1"><span class="nav-number"></span> <span class="nav-text">并将名称保存到 DIR_SRCS 变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#添加-math-子目录"><span class="nav-number"></span> <span class="nav-text">添加 math 子目录</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定生成目标-3"><span class="nav-number"></span> <span class="nav-text">指定生成目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#添加链接库"><span class="nav-number"></span> <span class="nav-text">添加链接库</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查找当前目录下的所有源文件-2"><span class="nav-number"></span> <span class="nav-text">查找当前目录下的所有源文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#并将名称保存到-DIR-LIB-SRCS-变量"><span class="nav-number"></span> <span class="nav-text">并将名称保存到 DIR_LIB_SRCS 变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#生成链接库"><span class="nav-number"></span> <span class="nav-text">生成链接库</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CMake-最低版本号要求-4"><span class="nav-number"></span> <span class="nav-text">CMake 最低版本号要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目信息-4"><span class="nav-number"></span> <span class="nav-text">项目信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#加入一个配置头文件，用于处理-CMake-对源码的设置"><span class="nav-number"></span> <span class="nav-text">加入一个配置头文件，用于处理 CMake 对源码的设置</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#是否使用自己的-MathFunctions-库"><span class="nav-number"></span> <span class="nav-text">是否使用自己的 MathFunctions 库</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#是否加入-MathFunctions-库"><span class="nav-number"></span> <span class="nav-text">是否加入 MathFunctions 库</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查找当前目录下的所有源文件-3"><span class="nav-number"></span> <span class="nav-text">查找当前目录下的所有源文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#并将名称保存到-DIR-SRCS-变量-2"><span class="nav-number"></span> <span class="nav-text">并将名称保存到 DIR_SRCS 变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定生成目标-4"><span class="nav-number"></span> <span class="nav-text">指定生成目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定-MathFunctions-库的安装路径"><span class="nav-number"></span> <span class="nav-text">指定 MathFunctions 库的安装路径</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定安装路径"><span class="nav-number"></span> <span class="nav-text">指定安装路径</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#启用测试"><span class="nav-number"></span> <span class="nav-text">启用测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试程序是否成功运行"><span class="nav-number"></span> <span class="nav-text">测试程序是否成功运行</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试帮助信息是否可以正常提示"><span class="nav-number"></span> <span class="nav-text">测试帮助信息是否可以正常提示</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试-5-的平方"><span class="nav-number"></span> <span class="nav-text">测试 5 的平方</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试-10-的-5-次方"><span class="nav-number"></span> <span class="nav-text">测试 10 的 5 次方</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试-2-的-10-次方"><span class="nav-number"></span> <span class="nav-text">测试 2 的 10 次方</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#定义一个宏，用来简化测试工作"><span class="nav-number"></span> <span class="nav-text">定义一个宏，用来简化测试工作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用该宏进行一系列的数据测试"><span class="nav-number"></span> <span class="nav-text">使用该宏进行一系列的数据测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#检查系统是否支持-pow-函数"><span class="nav-number"></span> <span class="nav-text">检查系统是否支持 pow 函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#构建一个-CPack-安装包"><span class="nav-number"></span> <span class="nav-text">构建一个 CPack 安装包</span></a></li></div></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2020</span><span class="with-love" id="animate"><i class="fa fa-heartbeat"></i></span> <span class="author" itemprop="copyrightHolder">云主宰苍穹</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">152k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">2:18</span></div><div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> 强力驱动 v3.9.0</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 – <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Pisces</span> v7.3.0</div><div class="busuanzi-count"><script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i> 访问用户：<span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人</span><div class="powered-by"></div><span class="site-uv"><i class="fa fa-eye"></i> 访问次数：<span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"middleRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script></div><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script><script src="/js/utils.js?v=7.3.0"></script><script src="/js/affix.js?v=7.3.0"></script><script src="/js/schemes/pisces.js?v=7.3.0"></script><script src="/js/next-boot.js?v=7.3.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js?v=7.3.0"></script><script src="/js/scrollspy.js?v=7.3.0"></script><script src="/js/post-details.js?v=7.3.0"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css"><script>NexT.utils.getScript("//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js",function(){new Gitalk({clientID:"aebff323e44f1516e521",clientSecret:"3934128e2a234e13b6118386667dee31ab703836",repo:"2694048168.github.io",owner:"2694048168",admin:["2694048168"],id:"fadfd7fb317b39d7921653060920c48f",language:"en | es-ES | fr | ru | zh-CN | zh-TW",distractionFreeMode:"true"}).render("gitalk-container")},window.Gitalk)</script></body></html>